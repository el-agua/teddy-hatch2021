{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport Card from \"../components/Card\";\nimport NavBar from \"../components/NavBar\";\nimport Link from \"next/link\";\nimport Button from \"../components/Button\";\nimport Column from \"../components/Column\";\nimport jwt_decode from \"jwt-decode\";\nimport axios from \"axios\";\n\nfunction PredictionFixer(pred) {\n  switch (pred) {\n    case -1:\n      return \"No Recommendation\";\n\n    case 0:\n      return \"Low Risk\";\n\n    case 1:\n      return \"Moderate Risk\";\n\n    case 2:\n      return \"Strong Risk\";\n\n    default:\n      return \"No Recommendation\";\n  }\n}\n\nconst Doctor = props => {\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsx(NavBar, {\n      userData: props.userData\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"flex p-7 justify-center\",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"flex justify-center\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: \"w-1/2 mb-4\",\n            children: /*#__PURE__*/_jsxs(Card, {\n              color: \"red-400\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"text-6xl text-white\",\n                children: /*#__PURE__*/_jsx(\"strong\", {\n                  children: props.userData ? props.userData.username : \"\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"text-xl text-white\",\n                children: /*#__PURE__*/_jsx(\"strong\", {\n                  children: \"Doctor Portal\"\n                })\n              })]\n            })\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"flex\",\n          children: [/*#__PURE__*/_jsx(Column, {\n            round: \"rounded-tl-lg\",\n            label: \"Patient\",\n            rows: props.patientData.map(patient => patient.user.username)\n          }), /*#__PURE__*/_jsx(Column, {\n            label: \"Email\",\n            rows: props.patientData.map(patient => patient.user.email)\n          }), /*#__PURE__*/_jsx(Column, {\n            label: \"Ethnicity\",\n            rows: props.patientData.map(patient => patient.ethnicity)\n          }), /*#__PURE__*/_jsx(Column, {\n            label: \"Diagnosis Age\",\n            rows: props.patientData.map(patient => patient.cancer_dx)\n          }), /*#__PURE__*/_jsx(Column, {\n            label: \"Cancer\",\n            rows: props.patientData.map(patient => patient.cancer_dx_type)\n          }), /*#__PURE__*/_jsx(Column, {\n            label: \"Age\",\n            rows: props.patientData.map(patient => patient.cancer_dx_age)\n          }), /*#__PURE__*/_jsx(Column, {\n            label: \"Prediction\",\n            rows: props.patientData.map(patient => PredictionFixer(patient.prediction))\n          }), /*#__PURE__*/_jsx(Column, {\n            round: \"rounded-tr-lg\",\n            label: \"History\",\n            rows: props.patientData.map(patient => /*#__PURE__*/_jsx(Button, {\n              color: \"purple-500\",\n              children: /*#__PURE__*/_jsx(Link, {\n                href: `/relation/${patient.id}`,\n                children: /*#__PURE__*/_jsx(\"div\", {\n                  className: \"text-sm\",\n                  children: \"View\"\n                })\n              })\n            }))\n          })]\n        })]\n      })\n    })]\n  });\n};\n\nexport async function getServerSideProps(context) {\n  const cookies = context.req.headers.cookie;\n\n  if (cookies == undefined) {\n    return {\n      redirect: {\n        destination: \"/login\",\n        permanent: false\n      }\n    };\n  }\n\n  var tok = cookies.substring(6);\n  var data;\n  var patientData;\n\n  if (tok != undefined && tok != \"undefined\") {\n    var decoded = jwt_decode(tok);\n    var id = decoded.user_id;\n    console.log(\"I'm here\");\n    await axios.get(`https://api.demo.federico.codes/users/${id}`, {\n      headers: {\n        'Authorization': `${tok}`\n      }\n    }).then(user => {\n      data = user.data;\n    }).catch(e => console.log(e));\n\n    if (data.admin == 0) {\n      return {\n        redirect: {\n          destination: \"/dashboard\",\n          permanent: false\n        }\n      };\n    }\n\n    await axios.get(`https://api.demo.federico.codes/patients`, {\n      headers: {\n        'Authorization': `${tok}`\n      }\n    }).then(user => {\n      patientData = user.data;\n    }).catch(e => console.log(e));\n  } else {\n    return {\n      redirect: {\n        destination: \"/login\",\n        permanent: false\n      }\n    };\n  }\n\n  console.log(patientData);\n\n  if (patientData.length == 0) {\n    return {\n      props: {\n        userData: data,\n        patientData: patientData\n      }\n    };\n  } else {\n    return {\n      props: {\n        userData: data,\n        patientData: patientData\n      } // will be passed to the page component as props\n\n    };\n  }\n}\nexport default Doctor;","map":null,"metadata":{},"sourceType":"module"}